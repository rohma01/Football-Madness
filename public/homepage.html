<!DOCTYPE html>
<html lang="en"></html>
<html>

<head>
    <style type="text/css">
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            font-family: 'Times New Roman', Times, serif;
        }

        .background {
            background-color: green;
            height: 100vh;
            width: 100vw;
        }

        h1 {
            font-size: 70px;
            padding-top: 10px;
            color: white;
            position: relative;
            text-align: center;
        }

        #name {
            position: absolute;
            right: 10px;
            top: 10px;
        }

        .directory {
            display: flex;
            justify-content: space-around;
        }

        button {
            font-size: 30pt;
            padding: 1%;
        }

        table {
            display: flex;
            justify-content: space-around;
            padding: 1%;
        }

        td,
        th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        th {
            text-align: center;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }

        .advance {
            display: flex;
            padding: 1%;
            position: absolute;
            right: 0;
            bottom: 0;
            white-space: nowrap;
        }
        .draft-button {
            border: 2px solid yellow;
        }
    </style>
</head>

<body>
    <div class="background">
        <div id="name"></div>
        <h1>Football Madness</h1>
        <div class="directory">
            <a id = "draftButton" href="draft.html"><button>Draft</button></a>
            <a id = "myteamButton" href="myteam.html"><button>Matchup</button></a>
            <a id = "leagueButton" href="league.html"><button>League</button></a>
        </div>
        <div class="table-container">
            <div class="table-header">
              <span>Player</span>
              <span>Team</span>
              <span>Position</span>
              <span>Points</span>
            </div>
            <!-- Table rows will be added here -->
          </div>
        <div class="advance">
            <button id="simulate">SIM</button>
            <button id="nextWeek">NEXT WEEK</button>
        </div>
    </div>
    <script type="text/javascript">
        let name = document.getElementById('name');
        
        let tableContainer = document.querySelector('.table-container');
        let currentUser = "Vedant"//JSON.parse(localStorage.getItem('user'))
        
        //name.textContent = currentUser.username;

        let opponent; //this has to be the current opponent which we have to cycle through somehow
        let matchup = {
            user1: currentUser,
            user2: "Rohith"
        };
        //const Matchup = require("../Matchup")
        let nextButton = document.getElementById("nextWeek")
        nextButton.disabled = true;
        let users = ["Sai","Vedant","Rohith","Khushil"]
        console.log(users.indexOf(currentUser))
        let otherUsers = users;
        otherUsers.splice(1,1);
        console.log(otherUsers)
        /*
        let playersData = currentUser.team;
        playersData.forEach(function(player) {
            let row = document.createElement('div');
            row.classList.add('table-row');
            row.innerHTML = '<span>' + player.player + '</span>' +
                            '<span>' + player.team + '</span>' +
                            '<span>' + player.position + '</span>' +
                            '<span>' + player.points + '</span>';
            tableContainer.appendChild(row);
        });
        
        let opponentData = matchup.user2;
        opponentData.forEach(function(player) {
            let row = document.createElement('div');
            row.classList.add('table-row');
            row.innerHTML = '<span>' + player.player + '</span>' +
                            '<span>' + player.team + '</span>' +
                            '<span>' + player.position + '</span>' +
                            '<span>' + player.points + '</span>';
            tableContainer.appendChild(row);
        });
        */
        // Function to get the query parameter by name
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Check the draftStatus and update the draft button style
        document.addEventListener("DOMContentLoaded", function () {
            const draftStatus = getQueryParam("draftStatus");

            // Assuming "notStarted" means yellow border, you can modify this condition
            if (draftStatus === "notStarted" || draftStatus==="inProgress") {
                // Select the draft button by its ID and add the yellow border class
                const draftButton = document.getElementById("draftButton");
                if (draftButton) {
                    draftButton.classList.add("draft-button");
                }
            }
        });

        let simButton = document.getElementById("simulate")
        simButton.addEventListener("click",function(){
            
/*
            for(let user of users){
                for(let player of user.team){
                    //fetch data and post to database
                }
            }
            */
            //location.reload();
            simButton.disabled = true;
            nextButton.disabled = false;
        })

        nextButton.addEventListener("click",function(){
            //logic for the next week functionality
            let currentOpponent = matchup.user2;
            let targetIndex = otherUsers.indexOf(currentOpponent)+1
            if(targetIndex==otherUsers.length){targetIndex=0}
            for(let x=0; x<otherUsers.length; x++){
                if(x==targetIndex){
                    console.log(otherUsers[x])
                    matchup = {
                        user1: currentUser,
                        user2: otherUsers[x]
                    }
                }
            }

            
            //location.reload();
        })

        
    </script>
</body>

</html>